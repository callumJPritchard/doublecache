var o=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports);var M=o((d,g)=>{(function(i,e){typeof define=="function"&&define.amd?define([],e):typeof d=="object"?g.exports=e():i.hash=e()})(d,function(){function i(e){"use strict";for(var t=5381,s=e.length;s;)t=t*33^e.charCodeAt(--s);return t>>>0}return i})});var f=o((Y,D)=>{"use strict";var P=M();D.exports=function(e){return P(e).toString(16)}});var p=o(u=>{"use strict";var y=u&&u.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(u,"__esModule",{value:!0});u.DiskCache=void 0;var R=y(f()),S=require("util"),l=y(require("fs")),F=y(require("os")),k=class{constructor(e){this.directory=((e==null?void 0:e.directory)||process.env.CACHE_DIRECTORY||F.default.tmpdir())+"/cacheDirectory";let t=0;for(;l.default.existsSync(this.directory);)this.directory=((e==null?void 0:e.directory)||process.env.CACHE_DIRECTORY||F.default.tmpdir())+`/cacheDirectory${t++}`;l.default.mkdirSync(this.directory)}async get(e,t){let a=(await this.getFile(e)).find(c=>c.key===e);if(!!a&&!(t&&a.age+t<Date.now()))return await this.setBase(a),a.value}async setBase(e){let t=await this.getFile(e.key),s=t.findIndex(c=>c.key===e.key),a={key:e.key,value:e.value,age:e.age,lastAccess:Date.now()};s>=0?t[s]=a:t.push(a),await this.setFile(e.key,t)}async set(e,t){await this.setBase({key:e,value:t,age:Date.now(),lastAccess:Date.now()})}async getFile(e){try{let t=await(0,S.promisify)(l.default.readFile)(this.keyToFileName(e));return JSON.parse(t.toString())}catch{return[]}}async setFile(e,t){await(0,S.promisify)(l.default.writeFile)(this.keyToFileName(e),JSON.stringify(t))}keyToFileName(e){return`${this.directory}/${(0,R.default)(e)}`}};u.DiskCache=k});var z=o(r=>{"use strict";var T=r&&r.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(r,"__esModule",{value:!0});r.AutoAdjustingMemoryCache=r.MemoryCache=void 0;var A=T(require("os")),_=class{constructor(e,t){this.cache=[],this.thresholdCounter=0,this.maxSize=e,this.trimThreshold=t||Math.ceil(this.maxSize*.5)}async get(e,t){let s=this.cache.find(a=>a.key===e);if(!!s&&!(t&&s.age+t<Date.now()))return this.setBase({key:e,value:s.value,age:s.age,lastAccess:Date.now()}),s.value}setBase(e){let t=this.cache.findIndex(s=>s.key===e.key);t>-1?this.cache[t]=e:this.cache.push(e)}async set(e,t){this.setBase({key:e,value:t,age:Date.now(),lastAccess:Date.now()}),this.thresholdCounter++>=this.trimThreshold&&(this.thresholdCounter=0,this.trim())}trim(){this.cache.sort((e,t)=>t.lastAccess-e.lastAccess),this.cache.length=Math.min(this.maxSize,this.cache.length)}};r.MemoryCache=_;var b=class extends _{constructor(e){super(e.initialMaxSize);this.targetMemFrac=e.targetMemPercent/100,this.minimumSize=e.minimumSize||10}trim(){let e=A.default.totalmem(),s=A.default.freemem()/e;if(s<this.targetMemFrac)return;let a=s-this.targetMemFrac;this.cache.sort((c,h)=>h.lastAccess-c.lastAccess),this.cache.length=Math.min(Math.floor(this.cache.length-this.cache.length*a*.5),this.minimumSize)}};r.AutoAdjustingMemoryCache=b});var O=o(n=>{"use strict";var B=n&&n.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(n,"__esModule",{value:!0});n.cacheifyFunc=n.CombineCaches=void 0;var I=B(f()),q=class{constructor(...e){this.caches=e}async get(e,t){for(let s=0;s<this.caches.length;s++){let a=await this.caches[s].get(e,t);if(a){for(;s--;)await this.caches[s].set(e,a);return a}}}async set(e,t){for(let s of this.caches)await s.set(e,t)}};n.CombineCaches=q;function N(i,e){let t=e.name||(0,I.default)(e.toString()),s=async function(c,...h){if(c.dontCache)return await e(...h);let v=`${t}-${JSON.stringify(h)}`,w=await i.get(v,c.maxAge);if(w)return w;let C=await e(...h);return await i.set(v,C),C},a=(...c)=>s({},...c);return a.config=c=>(...h)=>s(c,...h),a}n.cacheifyFunc=N});"use strict";Object.defineProperty(exports,"__esModule",{value:!0});exports.cacheify=exports.multicache=void 0;var $=p(),E=z(),j=O(),m=class{constructor(e){this.combinedCache=new j.CombineCaches(new E.AutoAdjustingMemoryCache({minimumSize:(e==null?void 0:e.minimumSize)||10,initialMaxSize:(e==null?void 0:e.initialMaxSize)||1e3,targetMemPercent:(e==null?void 0:e.targetMemPercent)||90}),new $.DiskCache),this.get=this.combinedCache.get,this.set=this.combinedCache.set}static getInstance(){return this._instance||(this._instance=new m),this._instance}},x=m.getInstance();exports.multicache=x;function H(i){return(0,j.cacheifyFunc)(x,i)}exports.cacheify=H;
//# sourceMappingURL=index.js.map
